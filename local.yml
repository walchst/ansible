---

- hosts: localhost
  connection: local
  user: walchst
  become: true

  pre_tasks:
    - name: install updates (Debian)
      apt:
        upgrade: dist
        update_cache: yes
      when: ansible_os_family == 'Debian'

  tasks:
    - include: roles/common.yml
    - include: roles/laptop.yml
      when: ansible_product_name == "XPS 13 9300"
    - include: roles/desktop.yml
      when: ansible_product_name is search("Standard PC")
    - include: tasks/dotfiles.yml
    - include: tasks/gnome.yml
      when: lookup('env','DESKTOP_SESSION') == "gnome"
    - include: tasks/cleanup.yml
